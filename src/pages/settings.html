<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#2e463b">
    <title>Instellingen - de Gazon App</title>

    <!-- Centrale CSS -->
    <link rel="stylesheet" href="../assets/css/main.css">

    <style>
        /* Toggle switch */
        .toggle-switch {
            position: relative;
            width: 48px;
            height: 26px;
            background: rgba(255,255,255,0.2);
            border-radius: 13px;
            cursor: pointer;
            transition: background var(--transition-fast);
        }
        .toggle-switch.active {
            background: var(--color-accent);
        }
        .toggle-switch::after {
            content: '';
            position: absolute;
            top: 3px;
            left: 3px;
            width: 20px;
            height: 20px;
            background: var(--color-white);
            border-radius: 50%;
            transition: transform var(--transition-fast);
        }
        .toggle-switch.active::after {
            transform: translateX(22px);
        }

        /* Modal overlay */
        .modal-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.7);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }
        .modal-overlay.active {
            display: flex;
        }
        .modal-content {
            background: var(--color-primary);
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            max-width: 340px;
            width: 100%;
            border: 1px solid rgba(255,255,255,0.15);
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="page-header">
        <h1>Instellingen</h1>
        <p>Beheer je account</p>
    </header>

    <!-- Content -->
    <main class="page-content">

        <!-- Profile Card -->
        <section class="card">
            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                <div id="profile-avatar-container" style="position: relative; cursor: pointer;">
                    <div id="profile-avatar" style="width: 64px; height: 64px; border-radius: 50%; background: linear-gradient(135deg, var(--color-accent), #538731); display: flex; align-items: center; justify-content: center; font-size: 1.5rem; font-weight: 700; overflow: hidden;">
                        <span data-user-name>GU</span>
                    </div>
                    <div style="position: absolute; bottom: 0; right: 0; width: 24px; height: 24px; border-radius: 50%; background: var(--color-orange); display: flex; align-items: center; justify-content: center; border: 2px solid var(--color-primary);">
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                            <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path>
                            <circle cx="12" cy="13" r="4"></circle>
                        </svg>
                    </div>
                    <input type="file" id="profile-photo-input" accept="image/*" style="display: none;">
                </div>
                <div style="flex: 1;">
                    <h2 id="profile-name" style="font-size: 1.125rem; font-weight: 600; margin: 0;" data-user-name>Gazon Gebruiker</h2>
                    <p id="profile-email" class="text-muted" style="font-size: 0.8rem; margin: 0.25rem 0 0;">gazon@voorbeeld.nl</p>
                    <p id="profile-location" class="text-muted" style="font-size: 0.75rem; margin: 0.125rem 0 0;">Nederland</p>
                </div>
            </div>
            <button id="edit-profile-btn" class="btn btn-secondary">Profiel bewerken</button>
        </section>

        <!-- Garden Data -->
        <section class="card">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem;">
                <h3 class="card-title" style="margin: 0;">Gazon Gegevens</h3>
                <button id="edit-gazon-btn" style="padding: 0.375rem 0.75rem; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); border-radius: 0.375rem; color: white; font-size: 0.75rem; cursor: pointer;">Bewerken</button>
            </div>
            <div style="display: flex; flex-direction: column; gap: 0.75rem;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <span class="text-muted" style="font-size: 0.875rem;">Oppervlakte</span>
                    <span id="gazon-area" style="font-weight: 600; font-size: 0.875rem;">100 m²</span>
                </div>
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <span class="text-muted" style="font-size: 0.875rem;">Type gras</span>
                    <span id="gazon-type" style="font-weight: 600; font-size: 0.875rem;">Speelgazon</span>
                </div>
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <span class="text-muted" style="font-size: 0.875rem;">Grondsoort</span>
                    <span id="gazon-soil" style="font-weight: 600; font-size: 0.875rem;">Aarde</span>
                </div>
            </div>
        </section>

        <!-- App Settings -->
        <section class="card">
            <h3 class="card-title">App Instellingen</h3>
            <div style="display: flex; flex-direction: column; gap: 1rem;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <p style="font-weight: 500; margin: 0; font-size: 0.9rem;">Donkere modus</p>
                        <p class="text-muted" style="font-size: 0.75rem; margin: 0.125rem 0 0;">Altijd aan (vaste modus)</p>
                    </div>
                    <div class="toggle-switch active" id="dark-mode-toggle"></div>
                </div>
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <p style="font-weight: 500; margin: 0; font-size: 0.9rem;">Push notificaties</p>
                        <p class="text-muted" style="font-size: 0.75rem; margin: 0.125rem 0 0;">Ontvang herinneringen</p>
                    </div>
                    <div class="toggle-switch" id="push-toggle"></div>
                </div>
            </div>
        </section>

        <!-- About -->
        <section class="card">
            <h3 class="card-title">Over</h3>
            <div style="display: flex; flex-direction: column; gap: 0.75rem;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <span class="text-muted" style="font-size: 0.875rem;">App versie</span>
                    <span style="font-weight: 500; font-size: 0.875rem;">v1.0.0</span>
                </div>
                <a href="https://graszoden.expert" target="_blank" style="display: flex; justify-content: space-between; align-items: center; text-decoration: none; padding: 0.5rem 0; border-top: 1px solid rgba(255,255,255,0.1); color: white;">
                    <span style="font-size: 0.875rem;">Bezoek onze website</span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="rgba(255,255,255,0.5)" stroke-width="2">
                        <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                        <polyline points="15 3 21 3 21 9"></polyline>
                        <line x1="10" y1="14" x2="21" y2="3"></line>
                    </svg>
                </a>
                <a href="https://graszoden.expert/" target="_blank" style="display: flex; justify-content: space-between; align-items: center; text-decoration: none; padding: 0.5rem 0; border-top: 1px solid rgba(255,255,255,0.1); color: white;">
                    <span style="font-size: 0.875rem;">Bekijk onze producten</span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="rgba(255,255,255,0.5)" stroke-width="2">
                        <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                        <polyline points="15 3 21 3 21 9"></polyline>
                        <line x1="10" y1="14" x2="21" y2="3"></line>
                    </svg>
                </a>
                <a href="https://wa.me/31625251258" target="_blank" style="display: flex; justify-content: space-between; align-items: center; text-decoration: none; padding: 0.5rem 0; border-top: 1px solid rgba(255,255,255,0.1); color: white;">
                    <span style="font-size: 0.875rem;">Contact via WhatsApp</span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="#25D366">
                        <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
                    </svg>
                </a>
            </div>
        </section>

        <!-- Account -->
        <section class="card">
            <h3 class="card-title">Account</h3>
            <p class="text-muted" style="font-size: 0.8rem; margin: 0 0 1rem;">Lid sinds januari 2024</p>
            <button id="logout-btn" style="width: 100%; padding: 0.875rem; background: rgba(220,53,69,0.15); border: 1px solid rgba(220,53,69,0.4); border-radius: var(--radius-md); color: #ff6b6b; font-size: 0.9rem; font-weight: 600; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 0.5rem;">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                    <polyline points="16 17 21 12 16 7"></polyline>
                    <line x1="21" y1="12" x2="9" y2="12"></line>
                </svg>
                Uitloggen
            </button>
        </section>

    </main>

    <!-- Profile Edit Modal -->
    <div class="modal-overlay" id="profile-modal">
        <div class="modal-content">
            <h3 style="font-size: 1.125rem; font-weight: 600; margin: 0 0 1rem;">Profiel bewerken</h3>
            <label class="form-label">Naam</label>
            <input type="text" class="form-input" id="input-name" placeholder="Je naam">
            <label class="form-label">Email</label>
            <input type="email" class="form-input" id="input-email" placeholder="je@email.nl">
            <label class="form-label">Stad</label>
            <input type="text" class="form-input" id="input-city" placeholder="Amsterdam">
            <label class="form-label">Land</label>
            <select class="form-select" id="input-country">
                <option value="Nederland">Nederland</option>
                <option value="België">België</option>
                <option value="Duitsland">Duitsland</option>
                <option value="Luxemburg">Luxemburg</option>
            </select>
            <div style="display: flex; gap: 0.75rem; margin-top: 0.5rem;">
                <button id="cancel-profile" class="btn btn-secondary">Annuleren</button>
                <button id="save-profile" class="btn btn-primary">Opslaan</button>
            </div>
        </div>
    </div>

    <!-- Garden Edit Modal -->
    <div class="modal-overlay" id="gazon-modal">
        <div class="modal-content">
            <h3 style="font-size: 1.125rem; font-weight: 600; margin: 0 0 1rem;">Gazon gegevens</h3>
            <label class="form-label">Oppervlakte (m²)</label>
            <input type="number" class="form-input" id="input-area" placeholder="100">
            <label class="form-label">Type gras</label>
            <select class="form-select" id="input-type">
                <option value="Siergazon">Siergazon</option>
                <option value="Speelgazon">Speelgazon</option>
                <option value="Schaduwgazon">Schaduwgazon</option>
                <option value="Sportgazon">Sportgazon</option>
            </select>
            <label class="form-label">Grondsoort</label>
            <select class="form-select" id="input-soil">
                <option value="Aarde">Aarde</option>
                <option value="Klei">Klei</option>
                <option value="Zand">Zand</option>
                <option value="Veen">Veen</option>
            </select>
            <div style="display: flex; gap: 0.75rem; margin-top: 0.5rem;">
                <button id="cancel-gazon" class="btn btn-secondary">Annuleren</button>
                <button id="save-gazon" class="btn btn-primary">Opslaan</button>
            </div>
        </div>
    </div>    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <a href="#" onclick="event.preventDefault(); window.router.navigate('home')" class="nav-item">
            <div class="nav-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
                    <polyline points="9 22 9 12 15 12 15 22"/>
                </svg>
            </div>
            <span class="nav-label">Home</span>
        </a>
        <a href="#" onclick="event.preventDefault(); window.router.navigate('fertilizer-planner')" class="nav-item">
            <div class="nav-icon">
                <div class="calendar-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                        <line x1="16" y1="2" x2="16" y2="6"/>
                        <line x1="8" y1="2" x2="8" y2="6"/>
                        <line x1="3" y1="10" x2="21" y2="10"/>
                    </svg>
                    <span class="calendar-day"></span>
                </div>
            </div>
            <span class="nav-label">Kalender</span>
        </a>
        <a href="#" onclick="event.preventDefault(); window.router.navigate('loyalty')" class="nav-item">
            <div class="nav-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
                </svg>
            </div>
            <span class="nav-label">Punten</span>
        </a>
        <a href="#" onclick="event.preventDefault(); window.router.navigate('challenge')" class="nav-item">
            <div class="nav-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/>
                    <path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/>
                    <path d="M4 22h16"/>
                    <path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"/>
                    <path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"/>
                    <path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/>
                </svg>
            </div>
            <span class="nav-label">Challenge</span>
        </a>
        <a href="#" onclick="event.preventDefault(); window.router.navigate('settings')" class="nav-item active">
            <div class="nav-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="3"/>
                    <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>
                </svg>
            </div>
            <span class="nav-label">Settings</span>
        </a>
    </nav>

    <!-- Centrale JS -->
    <script src="../assets/js/main.js"></script>

    <!-- Pagina-specifieke JS -->
    <script>
        // Initialize on load
        document.addEventListener('DOMContentLoaded', function() {
            loadSettings();
            setupEventListeners();
        });

        function loadSettings() {
            const data = GazonApp.getUserData();

            // Update profile display
            document.getElementById('profile-name').textContent = data.profile.name;
            document.getElementById('profile-email').textContent = data.profile.email || 'gazon@voorbeeld.nl';
            document.getElementById('profile-location').textContent = data.profile.country || 'Nederland';

            // Update avatar initials
            const initials = data.profile.name.split(' ').map(n => n[0]).join('').toUpperCase();
            document.querySelector('#profile-avatar span').textContent = initials;

            // Update garden data
            document.getElementById('gazon-area').textContent = data.garden.size + ' m²';
            document.getElementById('gazon-type').textContent = data.garden.grassType;
            document.getElementById('gazon-soil').textContent = data.garden.soilType;

            // Update toggles
            if (data.settings.pushNotifications) {
                document.getElementById('push-toggle').classList.add('active');
            }
        }

        function setupEventListeners() {
            // Edit profile
            document.getElementById('edit-profile-btn').addEventListener('click', openProfileModal);
            document.getElementById('cancel-profile').addEventListener('click', closeProfileModal);
            document.getElementById('save-profile').addEventListener('click', saveProfile);

            // Edit garden
            document.getElementById('edit-gazon-btn').addEventListener('click', openGazonModal);
            document.getElementById('cancel-gazon').addEventListener('click', closeGazonModal);
            document.getElementById('save-gazon').addEventListener('click', saveGazon);

            // Toggles
            document.getElementById('push-toggle').addEventListener('click', togglePush);

            // Logout
            document.getElementById('logout-btn').addEventListener('click', logout);

            // Close modals on overlay click
            document.querySelectorAll('.modal-overlay').forEach(modal => {
                modal.addEventListener('click', function(e) {
                    if (e.target === this) this.classList.remove('active');
                });
            });
        }

        function openProfileModal() {
            const data = GazonApp.getUserData();
            document.getElementById('input-name').value = data.profile.name;
            document.getElementById('input-email').value = data.profile.email || '';
            document.getElementById('input-city').value = data.profile.city || '';
            document.getElementById('input-country').value = data.profile.country || 'Nederland';
            document.getElementById('profile-modal').classList.add('active');
        }

        function closeProfileModal() {
            document.getElementById('profile-modal').classList.remove('active');
        }

        function saveProfile() {
            const data = GazonApp.getUserData();
            data.profile.name = document.getElementById('input-name').value;
            data.profile.email = document.getElementById('input-email').value;
            data.profile.city = document.getElementById('input-city').value;
            data.profile.country = document.getElementById('input-country').value;
            GazonApp.saveUserData(data);
            loadSettings();
            closeProfileModal();
            GazonApp.showToast('Profiel opgeslagen', 'success');
        }

        function openGazonModal() {
            const data = GazonApp.getUserData();
            document.getElementById('input-area').value = data.garden.size;
            document.getElementById('input-type').value = data.garden.grassType;
            document.getElementById('input-soil').value = data.garden.soilType;
            document.getElementById('gazon-modal').classList.add('active');
        }

        function closeGazonModal() {
            document.getElementById('gazon-modal').classList.remove('active');
        }

        function saveGazon() {
            const data = GazonApp.getUserData();
            data.garden.size = parseInt(document.getElementById('input-area').value);
            data.garden.grassType = document.getElementById('input-type').value;
            data.garden.soilType = document.getElementById('input-soil').value;
            GazonApp.saveUserData(data);
            loadSettings();
            closeGazonModal();
            GazonApp.showToast('Gazon gegevens opgeslagen', 'success');
        }

        function togglePush() {
            const toggle = document.getElementById('push-toggle');
            const data = GazonApp.getUserData();
            data.settings.pushNotifications = !data.settings.pushNotifications;
            GazonApp.saveUserData(data);
            toggle.classList.toggle('active');
            GazonApp.showToast('Instellingen bijgewerkt', 'success');
        }

        function logout() {
            if (confirm('Weet je zeker dat je wilt uitloggen?')) {
                localStorage.clear();
                GazonApp.showToast('Uitgelogd', 'success');
                setTimeout(() => {
                    window.location.href = '../index.html';
                }, 1000);
            }
        }
    </script>
</body>
</html>
